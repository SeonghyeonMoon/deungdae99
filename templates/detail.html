<!DOCTYPE html>
<html lang="kr">
  <head>
    <meta charset="UTF-8" />
    <title>상세페이지</title>
    <link
      href="//spoqa.github.io/spoqa-han-sans/css/SpoqaHanSansNeo.css"
      rel="stylesheet"
      type="text/css"
    />
    <!-- JQuery -->
     <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
     <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
    <!--    스타일 시트로 따로 뺄 경우
    @import url(//spoqa.github.io/spoqa-han-sans/css/SpoqaHanSansNeo.css);-->
    <style>
      /*전체 폰트*/
      * {
        font-family: "Spoqa Han Sans Neo", "sans-serif";
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      /*상단 파란색 헤더*/
      .header {
        height: 80px;
        background-color: #202540;
        color: white;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      /* 로고 */
      .logo {
        margin-left: 30px;
      }
      .logo a img {
        height: 40px;
      }
      .login {
        all: unset;
        margin-right: 30px;
      }
      .show_id {
        all: unset;
        margin-right: 30px;
      }
      #logout {
        all: unset;
        margin-right: 30px;
        cursor: pointer;
      }
      .login_box a {
        all: unset;
        margin-right: 30px;
        cursor: pointer;
      }
      /*햄버거 아이콘*/
      .icon {
        width: 35px;
        height: 5px;
        background-color: white;
        margin: 6px 0;
      }
      /*body 설정 기본은 가운데 정렬*/
      body {
        text-align: center;
      }
      /*본문*/
      .wrap {
        margin: 0 auto;
      }
      /*제목 감싸는 부분*/
      .title {
        width: 80%;
        margin: auto;
        padding-left: 30px;
      }
      /*제목*/
      h1 {
        text-align: left;
      }
      /*썸네일 들어갈 부분*/
      .img {
        width: 80%;
        height: 50vh;
        background-color: lightcoral;
        background-repeat:no-repeat;
        background-position: center;
        background-size: cover;
        margin: auto;
        border-radius: 10px;
        background-image: url("{{post['Content']['img']}}");
        border: 2px solid black;
      }
      /*포스팅 링크*/
      .post-link {
        margin: auto;
        width: 80%;
        text-align: left;
      }
      /*좋아요 버튼*/
      .like {
        margin-top: 30px;
        width: 10%;
        height: 30px;
        background-color: #f50000;
        color: white;
        border-radius: 10px;
        border-width: 0px;
        font-weight: bold;
        cursor: pointer;
      }
      /*댓글 입력 칸*/
      .comment {
        margin-top: 20px;
        width: 80%;
        height: 80px;
        padding: 5px;
        overflow: hidden;
        resize: none;
        line-height: 15px;
        border-radius: 10px;
      }
      /*댓글 작성 버튼*/
      .comment_input {
        margin: auto;
        width: 15%;
        height: 30px;
        background-color: #202540;
        color: white;
        border-radius: 10px;
        border-width: 0px;
        font-weight: bold;
      }
      /*작성한 댓글들 보여줄 곳*/
      .table {
        width: 80%;
        margin: 50px auto;
        text-align: center;
      }
      .hidden {
        display: none;
      }
    </style>
    <script>
      // 좋아요 버튼 확인용
      function like(id) {
        console.log(id)
        $.ajax({
          type: "POST",
          url: "/like",
          data: {id_give:id},
          success: function (response) {
            if (response["result"] === "success") {
              window.location.replace("");
            } else {
              alert(response["msg"]);
            }
          },
        })
      }
      // 댓글작성 버튼 확인용
      function comment_input() {
        alert("댓글작성");
      }
    </script>
  </head>
  <body>
    <!--헤더-->
    <div id="header" class="header">
      <!--    헤더 왼쪽 부분 (햄버거 아이콘 들어가는 곳)-->
        <h1 class="logo">
          <a href="/"><img src="https://hanghae99.spartacodingclub.kr/static/images/logo.svg" alt="logo"/></a>
      </h1>
      <!--로그인 버튼-->
      <button class="login" id="openModal">로그인</button>
      <!-- 로그인 했을 때 보여지는 파트 -->
      <div class="login_box hidden">
          <div class="show_id"></div>
          <button id="logout">로그아웃</button>
          <a href={{url_for('mypage')}}>마이페이지</a>
      </div>
    </div>
    <!--본문-->
    <div class="wrap">
      <!--    포스팅 제목-->
      <div class="title">
        <h1>{{post['Title']}}</h1>
      </div>
      <main>
        <!--        썸네일 들어갈 곳-->
        <div class="img"></div>
        <!--        포스팅 링크 들어갈 곳 -->
        <div class="post-link">
          <h4><a href={{post['Content']['url']}} target="_blank">{{post['Content']['url']}}</a></h4>
        </div>
        <!--        좋아요 버튼-->
        <p>
          <button onclick="like({{post['ID']}})" class="like">추천 {{post['like']}}</button>
        </p>
      </main>
    </div>
    <script>
      // 로그인 상태인지 확인
    function parseJwt (token) {
        let base64Url = token.split('.')[1];
        let base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
        let jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
    }).join(''));
        return JSON.parse(jsonPayload);
    }
    if (document.cookie) {
        let id = parseJwt(document.cookie)['id']
        document.querySelector('#openModal').classList.add('hidden')
        document.querySelector('.login_box').classList.remove('hidden')
        document.querySelector('.login_box .show_id').innerHTML = id + '님 반가워요'
    }
    </script>
  </body>
</html>